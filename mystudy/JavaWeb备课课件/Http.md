## Http请求消息

四部分：

1. 请求行
   1. 请求方法，请求地址，请求路径，请求参数（get方法），请求版本号
2. 请求头
   1. 如日期、客户端支持的 数据类型、语言、压缩格式、客户端和服务器的软件名称和版本、数据有 效期和最后更新时间等信息
   2. 消息头中的内容 随着浏览器类型、版本号、设置等的不同而不同，大多数情况下消息头的 长度为几行到十几行不等
3. 请求空行
   1. 就是一个空行，啥也不是
4. 请求体
   1. 请求参数（POST/PUT等请求）
   2. Get请求的请求参数在请求行。

### 请求方法

根据HTTP标准，HTTP请求可以使用多种请求方法。

HTTP1.0定义了三种请求方法： GET, POST 和 HEAD方法。

HTTP1.1新增了五种请求方法：OPTIONS, PUT, DELETE, TRACE 和 CONNECT 方法。

| 序号 | 方法    | 描述                                                         |
| :--- | :------ | :----------------------------------------------------------- |
| 1    | GET     | 请求指定的页面信息，并返回实体主体。                         |
| 2    | HEAD    | 类似于get请求，只不过返回的响应中没有具体的内容，用于获取报头 |
| 3    | POST    | 向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。数据被包含在请求体中。POST请求可能会导致新的资源的建立和/或已有资源的修改。 |
| 4    | PUT     | 从客户端向服务器传送的数据取代指定的文档的内容。             |
| 5    | DELETE  | 请求服务器删除指定的页面。                                   |
| 6    | CONNECT | HTTP/1.1协议中预留给能够将连接改为管道方式的代理服务器。     |
| 7    | OPTIONS | 允许客户端查看服务器的性能。                                 |
| 8    | TRACE   | 回显服务器收到的请求，主要用于测试或诊断。                   |

### 请求体

## TCP和IP

互联网和公司内部的局域网都是基于 TCP/IP 的思路来设计的

TCP/IP 的结构如图 1.8 所示，就是由一些 小的子网，通过路由器连接起来组成一个大的网络。这里的子网可以理解为用集线器连接起来的几台计算机，我们将它看作一个单位，称为子网。 将子网通过路由器连接起来，就形成了一个网络。

![image-20211214212018499](https://mynotepicbed.oss-cn-beijing.aliyuncs.com/img/image-20211214212018499.png)

在网络中，所有的设备都会被分配一个地址。这个地址就相当于现实 中某条路上的“×× 号 ×× 室”。其中“号”对应的号码是分配给整个子 网的，而“室”对应的号码是分配给子网中的计算机的，这就是网络中的 地址。

“号”对应的号码称为网络号，“室”对应的号码称为主机号，这个 地址的整体称为 IP 地址。

通过 IP 地址我们可以判断出访问对象服务器的位置，从而将消息发送到服务器。

消息传送的具体过程：

目标主机——子网集线器——最近的路由器——通过IP判断目标主机所在路由器的位置——集线器——目标路由器——目标主机

### IP地址

IP 地址是一串 32 比特的数字，按照 8 比特（1 字节）为一组分成 4 组，分别用十进制表示 然后再用圆点隔开。

在 IP 地址的规则 中，网络号和主机号连起来总共是 32 比特，但这两部分的具体结构是不固定的。

在组建网络时，用户可以自行决定网络号和主机号之间的分配关系，因此，我 们还需要另外的附加信息来表示 IP 地址的内部结构。

![image-20211214215209020](https://mynotepicbed.oss-cn-beijing.aliyuncs.com/img/image-20211214215209020.png)

子网掩码的格式如图所示，是一 串与 IP 地址长度相同的 32 比特数字，其左边一半都是 1，右边一半都是 0。其中，子网掩码为 1 的部分表示网络号，子网掩码为 0 的部分表示主机号。

![image-20211214220434205](https://mynotepicbed.oss-cn-beijing.aliyuncs.com/img/image-20211214220434205.png)

将子网掩码按照和 IP 地址一样的方式以每 8 比特为单位用圆点分组后 写在 IP 地址的右侧，这就是图 1.9（b）的方法。这种写法太长，我们也可 以把 1 的部分的比特数用十进制表示并写在 IP 地址的右侧，如图 1.9（c） 所示。这两种方式只是写法上的区别，含义是完全一样的。

**IP 地址的主机号** （见上图）

全 0：表示整个子网 

全 1：表示向子网上所有设备发送包，即“广播”

## 域名和IP地址并用的理由

TCP/IP 网络是通过 **IP 地址来确定通信对象**的，因此不知道 IP 地址就无法将消息发送给对方，这和我们打电话的时候必须要知道对方的电话号码是一个道理。因此，**在委托操作系统发送消息时，必须要先查询好对方 的 IP 地址。**

用 IP 地址来代替服务器名称也是能够正常工作的 。然而，就像你很难记住电话号码一样，要记住一串由数字组成 的 IP 地址也非常困难。因此，相比 IP 地址来说，网址中还是使用服务器 名称比较好。

**为什么不直接使用服务器名称？**

互联网中存在无数的路由器，它们之间相互配合，根据 IP 地址来判断应该把数据传送到什么地方。

IP 地址的长度 为 32 比特，也就是 4 字节，相对地，域名最短也要几十个字节，最长甚至 可以达到 255 字节。增加了路由器的负担，传送 数据也会花费更长的时间。



用户来使用名称，让路由器来使用 IP 地 址。为了填补两者之间的障碍，需要有一个机制能够通过名称来查询 IP 地址，或者通过 IP 地址来查询名称，这样就能够在人和机器双方都不做出牺牲的前提下完美地解决问题。这个机制就是 DNS。

 DNS：域名服务系统。将服务器名称和 IP 地址进行 关联是 DNS 最常见的用法，但 DNS 的功能并不仅限于此，它还可以将邮 件地址和邮件服务器进行关联，以及为各种信息关联相应的名称。

### Socket 库提供查询 IP 地址的功能





**Socket 库**是在加州大学伯克利分校开发的 UNIX 系操作系统 BSD 中开发的 C 语言库，互联网中所使用的大多数功能都是基于 Socket 库来开发的。因此， BSD 之外的其他操作系统以及 C 语言之外的其他编程语言也参照 Socket 库开 发了相应的网络库。可以说，Socket 库是网络开发中的一种标准库

### 通过解析器向 DNS 服务器发出查询

在编写浏览器等应用程序的时候，只 要写上解析器的程序名称“gethostbyname”以及 Web 服务器 的域名“www.lab.glasscom.com”就可以了，这样就完成了对解析器的调用。（除此之外还需要编写一些用于分配保存 IP 地址的内存空间的语 句，并在程序开头使用 #include 命令将其包含进来）

![image-20211214224334225](https://mynotepicbed.oss-cn-beijing.aliyuncs.com/img/image-20211214224334225.png)

调用解析器后，解析器会向 DNS 服务器发送查询消息，然后 DNS 服 务器会返回响应消息。响应消息中包含查询到的 IP 地址，解析器会取出 IP 地址，并将其**写入浏览器指定的内存地址**中。只要运行图 1.11 中的这一行 程序，就可以完成前面所有这些工作，我们也就完成了 IP 地址的查询。接下来，**浏览器在向 Web 服务器发送消息时，只要从该内存地址取出 IP 地 址，并将它与 HTTP 请求消息一起交给操作系统就可以了。**

